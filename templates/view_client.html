{% extends "base.html" %}

{% block title %}View Client{% endblock %}

{% block styles %}
<style>
    .form-label {
        font-size: 1.2rem;  /* bigger text */
        font-weight: 600;   /* bold */
        color: #333;        /* darker color */
    }
    .password-container {
    display: inline-flex;
    align-items: center;
    gap: 5px; /* space between input and icon */
}

.password-container .form-control-plaintext {
    width: 120px; /* smaller width so button stays close */
    padding: 4px 6px;
    font-size: 0.9rem;
}

.password-container button {
    padding: 4px 6px;
    font-size: 0.8rem;
    line-height: 1;
}

.form-control {
    border-width: 2px;
}

</style>
{% endblock %}


{% block content %}
<div class="container mt-5 p-4 bg-white rounded shadow-sm" style="max-width: 900px;">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="mb-0"><i class="fas fa-user me-2"></i>Client Details</h2>
        <div>
            <a href="{{ url_for('edit_client', id=client.id) }}" class="btn btn-sm btn-warning"><i class="fas fa-edit"></i> Edit</a>
            <a href="{{ url_for('clients_list') }}" class="btn btn-sm btn-secondary"><i class="fas fa-arrow-left"></i> Back</a>
        </div>
    </div>

    <div class="row g-3">
        <div class="col-md-6">
            <label class="form-label">Raison sociale</label>
            <input type="text" class="form-control copy-field" value="{{ client.company }}" readonly>
        </div>
        <div class="col-md-6">
            <label class="form-label">Contact name</label>
            <input type="text" class="form-control copy-field" value="{{ client.name }}" readonly>
        </div>

        <div class="col-md-4">
            <label class="form-label">Téléphone</label>
            <input type="text" class="form-control copy-field" value="{{ client.phone }}" readonly>
        </div>
        <div class="col-md-4">
            <label class="form-label">Email</label>
            <input type="text" class="form-control copy-field" value="{{ client.email }}" readonly>
        </div>
        <div class="col-md-4">
            <label class="form-label">ICE</label>
            <input type="text" class="form-control copy-field" value="{{ client.ice }}" readonly>
        </div>

        <div class="col-md-4">
            <label class="form-label">IF</label>
            <input type="text" class="form-control copy-field" value="{{ client.ifNumber }}" readonly>
        </div>
        <div class="col-md-4">
            <label class="form-label">RC</label>
            <input type="text" class="form-control copy-field" value="{{ client.rc }}" readonly>
        </div>
        <div class="col-md-4">
            <label class="form-label">TP</label>
            <input type="text" class="form-control copy-field" value="{{ client.tp }}" readonly>
        </div>

        <div class="col-md-4">
            <label class="form-label">CNSS</label>
            <input type="text" class="form-control copy-field" value="{{ client.cnss }}" readonly>
        </div>
        <div class="col-md-4">
            <label class="form-label">CNSS Login</label>
            <input type="text" class="form-control copy-field" value="{{ client.cnssLogin }}" readonly>
        </div>
        <div class="col-md-4">
    <label class="form-label">CNSS Password</label>
    <div class="password-container">
        <input type="password" class="form-control copy-field" value="{{ client.cnssPassword }}" readonly id="cnssPassword">
        <button type="button" class="btn btn-outline-secondary btn-sm" onclick="togglePassword('cnssPassword', this)">
            <i class="far fa-eye"></i>
        </button>
    </div>
</div>

        <div class="col-md-4">
            <label class="form-label">DGI Login</label>
            <input type="text" class="form-control copy-field" value="{{ client.dgiLogin }}" readonly>
        </div>
        <div class="col-md-4">
    <label class="form-label">DGI Password</label>
    <div class="password-container">
        <input type="password" class="form-control copy-field" value="{{ client.dgiPassword }}" readonly id="dgiPassword">
        <button type="button" class="btn btn-outline-secondary btn-sm" onclick="togglePassword('dgiPassword', this)">
            <i class="far fa-eye"></i>
        </button>
    </div>
</div>

        <div class="col-md-4">
            <label class="form-label">Adhesion Login</label>
            <input type="text" class="form-control copy-field" value="{{ client.adhesionLogin }}" readonly>
        </div>
        <div class="col-md-4">
    <label class="form-label">Adhesion Password</label>
    <div class="password-container">
        <input type="password" class="form-control copy-field" value="{{ client.adhesionPassword }}" readonly id="adhesionPassword">
        <button type="button" class="btn btn-outline-secondary btn-sm" onclick="togglePassword('adhesionPassword', this)">
            <i class="far fa-eye"></i>
        </button>
    </div>
</div>

    </div>

    <div class="mt-4 text-center">
        <form action="{{ url_for('delete_client', id=client.id) }}" method="post" onsubmit="return confirm('Delete this client?')">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button class="btn btn-danger">Delete Client</button>
        </form>
    </div>

</div>
<!-- Notification Toast -->
<div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
    <div id="copyToast" class="toast align-items-center text-white bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="d-flex">
            <div class="toast-body">
                <i class="fas fa-check-circle me-2"></i>
                Copied to clipboard!
            </div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
function togglePassword(id, btn) {
    const input = document.getElementById(id);
    if (!input) return;
    if (input.type === 'password') {
        input.type = 'text';
        btn.innerHTML = '<i class="far fa-eye-slash"></i>';
    } else {
        input.type = 'password';
        btn.innerHTML = '<i class="far fa-eye"></i>';
    }
}
document.addEventListener('DOMContentLoaded', function() {
    // Initialize Bootstrap Toast
    const toastEl = document.getElementById('copyToast');
    const toast = bootstrap.Toast ? new bootstrap.Toast(toastEl) : null;

    // Copy to clipboard on click
    document.querySelectorAll('.copy-field').forEach(field => {
        field.style.cursor = 'pointer';
        field.addEventListener('click', function() {
            this.select();
            if (navigator.clipboard) {
                navigator.clipboard.writeText(this.value).then(() => {
                    if (toast) toast.show();
                });
            } else {
                document.execCommand('copy') && toast && toast.show();
            }
        });
    });
});

</script>
{% endblock %}
